local selectedjobs = {}


local function autojob()

local DP = vgui.Create( "DFrame" )
DP:SetPos( 50,50 )
DP:SetSize( 300, 600 )
local Title = "JOB SNIPER"
DP:SetTitle( Title )
--DP:SetSizable(true)
DP:SetVisible( true )
DP:SetDraggable( true )
DP:ShowCloseButton( true )
DP:SizeToContents()
DP:MakePopup()
DP.Paint = function()
  surface.SetDrawColor( 255,20,147, 150 )
  surface.DrawRect( 0, 0, DP:GetWide(), DP:GetTall() )
  surface.SetDrawColor( 255,255,255, 255 )
  surface.DrawOutlinedRect( 0, 0, DP:GetWide(), DP:GetTall() )
end

DL = vgui.Create( "DPanelList", DP )
DL:SetPos( 10,25 )
DL:SetSize( 275, 570 ) 
DL:SetSpacing( 5 ) 
DL:EnableHorizontal( false )
DL:EnableVerticalScrollbar( true )

for k, v in pairs( RPExtraTeams ) do

    local jobnamepanel = vgui.Create( "DPanel", DL )
    jobnamepanel:SetPos( 0, 0 )
    jobnamepanel:SetSize( 300, 25 )
    jobnamepanel.Paint = function() -- Paint function
        draw.RoundedBoxEx(8,1,1,jobnamepanel:GetWide(),jobnamepanel:GetTall(),Color(0, 0, 0, 150), false, false, false, false)
        if selectedjobs[v] then surface.SetDrawColor(Color(255, 255, 255, 255)) else surface.SetDrawColor(Color(50, 50, 90, 255)) end
        surface.DrawOutlinedRect(1, 1, jobnamepanel:GetWide() - 1 , jobnamepanel:GetTall() - 1)
    end

    local jobnamebutton = vgui.Create("DButton", jobnamepanel)
    jobnamebutton:SetSize( jobnamepanel:GetWide(), jobnamepanel:GetTall() )
    jobnamebutton:SetPos( 0, 0 )
    jobnamebutton:SetText("")
    jobnamebutton.Paint = function(panel, w, h)
        return
    end

    local jobnamelabel = vgui.Create( "DLabel", jobnamepanel )
    jobnamelabel:SetPos( 10, 5 )
    jobnamelabel:SetFont( "Trebuchet18" )
    local whit = Color( 255, 255, 255 )
    jobnamelabel:SetColor( whit )
    jobnamelabel:SetText( v.name.." ("..team.NumPlayers(v.team).."/"..v.max..")" )
    jobnamelabel:SetSize(250, 15)

    jobnamebutton.DoClick = function()
        if selectedjobs[v] then 
            selectedjobs[v] = nil
        else
           selectedjobs[v] = v
        end
    end

    DL:AddItem( jobnamepanel )
    DL:AddItem( Entry )

end
end

hook.Add("Think","jewjobs", function()
      for k, v in pairs( RPExtraTeams ) do
    if selectedjobs[v] && team.NumPlayers(v.team) ~= v.max && LocalPlayer():Team() ~= v.team then
        if v.vote or v.RequiresVote then
        RunConsoleCommand("darkrp","vote"..v.command)
        else
        RunConsoleCommand("darkrp",v.command)
        selectedjobs[v] = nil
      end
    end
  end
end)

concommand.Add("zxc_jobsniper", autojob)

MsgC( Color( 255, 0, 255 ), "==========>-----     JOB SNIPER Initialized     -----<==========\n" )